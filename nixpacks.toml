# Tell Railway to install both Python and Node
providers = ["python", "nodejs"]

[phases.install]
# Install dependencies
cmds = ["npm --prefix frontend install", "pip install -r backend/requirements.txt"]

[phases.build]
# Build React
cmds = ["npm --prefix frontend run build"]

[start]
# THE HYBRID LAUNCHER:
# 1. Starts the Ticker Worker in the background (&)
# 2. Starts the Gunicorn API Server in the foreground
cmd = "python backend/worker.py & gunicorn backend.app.main:app --workers 4 --worker-class uvicorn.workers.UvicornWorker --bind 0.0.0.0:$PORT --timeout 120"